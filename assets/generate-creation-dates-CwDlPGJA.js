(function(){"use strict";onmessage=function(p){let a=new Set,f=0,m=p.data,h=m.length;for(let e of m){let t=e.name,l,s,n;t.toLowerCase().match(/(am\.[^.]*$|pm\.[^.]*$)/)&&(s=t.match(/(20\d\d).?([0-1]\d).?([0-3]\d)/)||Array(4).fill(""),t=t.replace(s[1],""),t=t.replace(s[2],""),t=t.replace(s[3],""),n=t.match(/([ 12]\d).?([0-5]\d).?([0-5]\d)/)||Array(4).fill(""),s=s.map(o=>parseInt(o)),n=n.map(o=>parseInt(o)),n[1]+=t.toLowerCase().match(/am\.[^.]*$/)?0:12,l=new Date(s[1],s[2]-1,s[3],n[1],n[2],n[3]).getTime()),l||(s=t.match(/(20\d\d).?([0-1]\d).?([0-3]\d)/)||Array(4).fill(""),t=t.replace(s[1],""),t=t.replace(s[2],""),t=t.replace(s[3],""),n=t.match(/([0-2]\d).?([0-5]\d).?([0-5]\d)/)||Array(4).fill(""),s=s.map(o=>parseInt(o)),n=n.map(o=>parseInt(o)),l=new Date(s[1],s[2]-1,s[3],n[1],n[2],n[3]).getTime()),l||(l=e.lastModified),l<Date.now()+2*864e5&&(l+=new Date(l).getTimezoneOffset()*-6e4,a.add(l)),f++;let P=Math.round(f/h*100);postMessage(`Files processed: ${P}% (${f}/${h})`)}postMessage("Sorting screenshots"),a=Array.from(a),a.sort((e,t)=>e-t),postMessage("Generating stats from screenshots");let d=Array(7).fill(0);a.forEach(e=>{let t=new Date(e).getTimezoneOffset()*6e4;return d[new Date(e+t).getDay()]++});let y=Array(7).fill(0);for(let e=1;e<a.length;e++)if(a[e]-a[e-1]<12e5){let t=new Date(a[e]).getTimezoneOffset()*6e4,l=new Date(a[e]+t).getDay();y[l]+=a[e]-a[e-1]}let D=Array(24).fill(0);a.forEach(e=>{let t=new Date(e).getTimezoneOffset()*6e4;return D[new Date(e+t).getHours()]++});let i={};for(let e of a){let t=new Date(e).toISOString().slice(0,10),l=new Date(t).getTime();i[l]=1+(i[l]||0)}let c={};for(let e=1;e<a.length;e++)if(a[e]-a[e-1]<12e5){let t=new Date(a[e]).toISOString().slice(0,10),l=new Date(t).getTime();c[l]=a[e]-a[e-1]+(c[l]||0)}let g=Array(12).fill(0);a.forEach(e=>{let t=new Date(e).getTimezoneOffset()*6e4;return g[new Date(e+t).getMonth()]++}),postMessage("Finishing touches");let r={};r.validFilesAmount=a.length,r.totalFiles=m.length,r.screenshotsPerDay_Week=d,r.millisecondsPerDay_Week=y,r.screenshotsPerHour_Day=D,r.screenshotsPerDay_Playtime=i,r.millisecondsPerDay_Playtime=c,r.screenshotsPerMonth_Playtime=g,r.daysSkyOpened=Object.keys(i).length,r.millisecondsPlayedTotal=y.reduce((e,t)=>e+t,0),r.screenshotsTotal=d.reduce((e,t)=>e+t,0),r.maxScreenshotsOnADay=Math.max(...Object.values(i)),r.maxMillisecondsOnADay=Math.max(...Object.values(c)),postMessage(r)}})();
